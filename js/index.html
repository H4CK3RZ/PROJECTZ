<!DOCTYPE html>
<html>
	<head>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
		<script>
			$(document).ready(function() {
				function rpcData(id) {
					$.getJSON( "dataRPC.html?id=" + id, function( data ) {
						var items = [];
						$.each( data, function( key, val ) {
							items.push( "<li id='" + key + "'>" + val + "</li>" );
						});

						$( "<ul/>", {
							"class": "my-new-list",
							html: items.join( "" )
						}).appendTo( "body" );
					}).done(function() {
						console.log("this is on done");
					}).always(function() {
						console.log("this is always done, success or not");
					});
				}
				$('.detect').click(function() {
					// UPDATE users SET authorised = authorised XOR 1 WHERE id = 2;
					var id = $(this).parent().children('.itemid').text();
					rpcData(id);
				});
			});
		</script>
	</head>
	<body>
		<div id="container">Ext Js Scroll top test</div>
		<div>
			<span class="itemid">12</span>
			<span>Content title</span>
			<span class="detect">link</span>
		</div>
	</body>
</html>
